df1 <- tibble(x = x1,
y = sinpi(x1/2),
pred = rcs(x1,10) %*% xgam$coefficients[2:10])
df2 <- tibble(x = x2,
y = cospi(x2/2),
pred = rcs(x2,10) %*% xgam$coefficients[11:19])
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
x1 <- rnorm(1000, 2)
x2 <- rnorm(1000, -4)
y <- sinpi(x1/2) + cospi(x2/2) + rnorm(1000, sd = 0.5)
df <- tibble(x1, x2, y)
xgam <- gam(y ~ rcs(x1,10) + rcs(x2, 10) - 1)
xgam$coefficients
df1 <- tibble(x = x1,
y = sinpi(x1/2),
pred = rcs(x1,10) %*% xgam$coefficients[2:10])
df2 <- tibble(x = x2,
y = cospi(x2/2),
pred = rcs(x2,10) %*% xgam$coefficients[11:19])
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
x1 <- rnorm(1000, 2)
x2 <- rnorm(1000, -4)
y <- sinpi(x1/2) + cospi(x2/2) + rnorm(1000, sd = 0.5)
df <- tibble(x1, x2, y)
xgam <- gam(y ~ rcs(x1,10) + rcs(x2, 10) - 1)
xgam$coefficients
df1 <- tibble(x = x1,
y = sinpi(x1/2),
pred = rcs(x1,10) %*% xgam$coefficients[1:9])
df2 <- tibble(x = x2,
y = cospi(x2/2),
pred = rcs(x2,10) %*% xgam$coefficients[10:18])
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
x1 <- rnorm(1000, 2)
x2 <- rnorm(1000, -4)
y <- sinpi(x1/2) + cospi(x2/2) + rnorm(1000, sd = 0.5)
df <- tibble(x1, x2, y)
xgam <- gam(y ~ rcs(x1,10) + rcs(x2, 10) - 1)
xgam$coefficients
df1 <- tibble(x = x1,
y = sinpi(x1/2),
pred = rcs(x1,10) %*% xgam$coefficients[1:9])
df2 <- tibble(x = x2,
y = cospi(x2/2),
pred = rcs(x2,10) %*% xgam$coefficients[10:18])
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
x1 <- rnorm(1000, 2)
x2 <- rnorm(1000, -4)
y <- sinpi(x1/2) + cospi(x2/2) + rnorm(1000, sd = 0.5)
df <- tibble(x1, x2, y)
xgam <- gam(y ~ rcs(x1,10) + rcs(x2, 10) - 1)
xgam$coefficients
df1 <- tibble(x = x1,
y = sinpi(x1/2),
pred = rcs(x1,10) %*% xgam$coefficients[1:9])
df2 <- tibble(x = x2,
y = cospi(x2/2),
pred = rcs(x2,10) %*% xgam$coefficients[10:18])
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
x1 <- rnorm(1000, 2)
x2 <- rnorm(1000, -4)
y <- sinpi(x1/2) + cospi(x2/2) + rnorm(1000, sd = 0.5)
df <- tibble(x1, x2, y)
xgam <- gam(y ~ rcs(x1,10) + rcs(x2, 10) - 1)
xgam$coefficients
df1 <- tibble(x = x1,
y = sinpi(x1/2),
pred = rcs(x1,10) %*% xgam$coefficients[1:9])
df2 <- tibble(x = x2,
y = cospi(x2/2),
pred = rcs(x2,10) %*% xgam$coefficients[10:18])
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
x1 <- rnorm(1000, 2)
x2 <- rnorm(1000, -4)
y <- sinpi(x1/2) + cospi(x2/2) + rnorm(1000, sd = 0.5)
df <- tibble(x1, x2, y)
xgam <- gam(y ~ rcs(x1,10) + rcs(x2, 10) - 1)
xgam$coefficients
df1 <- tibble(x = x1,
y = sinpi(x1/2),
pred = rcs(x1,10) %*% xgam$coefficients[1:9])
df2 <- tibble(x = x2,
y = cospi(x2/2),
pred = rcs(x2,10) %*% xgam$coefficients[10:18])
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
x1 <- rnorm(1000, 2)
x2 <- rnorm(1000, -4)
y <- sinpi(x1/2) + cospi(x2/2) + rnorm(1000, sd = 0.5)
df <- tibble(x1, x2, y)
xgam <- gam(y ~ rcs(x1,10) + rcs(x2, 10) - 1)
xgam$coefficients
df1 <- tibble(x = x1,
y = sinpi(x1/2),
pred = rcs(x1,10) %*% xgam$coefficients[1:9])
df2 <- tibble(x = x2,
y = cospi(x2/2),
pred = rcs(x2,10) %*% xgam$coefficients[10:18])
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
x1 <- rnorm(1000, 2)
x2 <- rnorm(1000, -4)
y <- sinpi(x1/2) + cospi(x2/2) + rnorm(1000, sd = 0.5)
df <- tibble(x1, x2, y)
xgam <- gam(y ~ rcs(x1,10) + rcs(x2, 10) - 1)
xgam$coefficients
df1 <- tibble(x = x1,
y = sinpi(x1/2),
pred = rcs(x1,10) %*% xgam$coefficients[1:9])
df2 <- tibble(x = x2,
y = cospi(x2/2),
pred = rcs(x2,10) %*% xgam$coefficients[10:18])
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
x1 <- rnorm(1000, 2)
x2 <- rnorm(1000, -4)
y <- sinpi(x1/2) + cospi(x2/2) + rnorm(1000, sd = 0.5)
df <- tibble(x1, x2, y)
xgam <- gam(y ~ rcs(x1,10) + rcs(x2, 10) - 1)
xgam$coefficients
df1 <- tibble(x = x1,
y = sinpi(x1/2),
pred = rcs(x1,10) %*% xgam$coefficients[1:9])
df2 <- tibble(x = x2,
y = cospi(x2/2),
pred = rcs(x2,10) %*% xgam$coefficients[10:18])
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
x1 <- rnorm(1000, 2)
x2 <- rnorm(1000, -4)
y <- sinpi(x1/2) + cospi(x2/2) + rnorm(1000, sd = 0.5)
df <- tibble(x1, x2, y)
xgam <- gam(y ~ rcs(x1,10) + rcs(x2, 10) - 1)
xgam$coefficients
df1 <- tibble(x = x1,
y = sinpi(x1/2),
pred = rcs(x1,10) %*% xgam$coefficients[1:9])
df2 <- tibble(x = x2,
y = cospi(x2/2),
pred = rcs(x2,10) %*% xgam$coefficients[10:18])
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
x1 <- rnorm(1000, 2)
x2 <- rnorm(1000, -4)
y <- 3 + sinpi(x1/2) + cospi(x2/2) + rnorm(1000, sd = 0.5)
df <- tibble(x1, x2, y)
xgam <- gam(y ~ rcs(x1,10) + rcs(x2, 10) - 1)
xgam$coefficients
df1 <- tibble(x = x1,
y = sinpi(x1/2),
pred = rcs(x1,10) %*% xgam$coefficients[1:9])
df2 <- tibble(x = x2,
y = cospi(x2/2),
pred = rcs(x2,10) %*% xgam$coefficients[10:18])
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
plot(xgam)
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df1 <- tibble(x = x1,
y = sinpi(x1/2) - mean(y),
pred = rcs(x1,10) %*% xgam$coefficients[1:9])
df1 <- tibble(x = x1,
y = sinpi(x1/2) - mean(y),
pred = rcs(x1,10) %*% xgam$coefficients[1:9])
df2 <- tibble(x = x2,
y = cospi(x2/2)-mean(y),
pred = rcs(x2,10) %*% xgam$coefficients[10:18])
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df1 <- tibble(x = x1,
y = sinpi(x1/2) = mean(y),
df1 <- tibble(x = x1,
y = sinpi(x1/2) + mean(y),
pred = rcs(x1,10) %*% xgam$coefficients[1:9])
df2 <- tibble(x = x2,
y = cospi(x2/2) +mean(y),
pred = rcs(x2,10) %*% xgam$coefficients[10:18])
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
plot(xgam)
x1 <- rnorm(1000, 2)
x2 <- rnorm(1000, -4)
y <- 3 + sinpi(x1/2) + cospi(x2/2) + rnorm(1000, sd = 0.5)
df <- tibble(x1, x2, y)
xgam <- gam(y ~ rcs(x1,10) + rcs(x2, 10) - 1)
xgam$coefficients
df1 <- tibble(x = x1,
y = sinpi(x1/2) + mean(y),
pred = rcs(x1,10) %*% xgam$coefficients[1:9])
df2 <- tibble(x = x2,
y = cospi(x2/2) + mean(y),
pred = rcs(x2,10) %*% xgam$coefficients[10:18])
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
xgam$coefficients
xgam$coefficients |> dim()
xgam$coefficients |> length()
xgam$coefficients
xgam <- gam(y ~ rcs(x1,10) + rcs(x2, 10))
xgam <- gam(y ~ rcs(x1,10) + rcs(x2, 10))
xgam$coefficients |> length()
df1 <- tibble(x = x1,
y = sinpi(x1/2) + mean(y),
pred = rcs(x1,10) %*% xgam$coefficients[2:10])
df2 <- tibble(x = x2,
y = cospi(x2/2) + mean(y),
pred = rcs(x2,10) %*% xgam$coefficients[11:19])
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df1 <- tibble(x = x1,
y = sinpi(x1/2) - mean(y),
pred = rcs(x1,10) %*% xgam$coefficients[2:10])
df2 <- tibble(x = x2,
y = cospi(x2/2) - mean(y),
pred = rcs(x2,10) %*% xgam$coefficients[11:19])
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
x1 <- rnorm(1000, 2)
x2 <- rnorm(1000, -4)
y <- 3 + sinpi(x1/2) + cospi(x2/2) + rnorm(1000, sd = 0.5)
df <- tibble(x1, x2, y)
xgam <- gam(y ~ rcs(x1,10) + rcs(x2, 10))
xgam$coefficients |> length()
df1 <- tibble(x = x1,
y = sinpi(x1/2) - mean(y),
pred = rcs(x1,10) %*% xgam$coefficients[2:10])
df2 <- tibble(x = x2,
y = cospi(x2/2) - mean(y),
pred = rcs(x2,10) %*% xgam$coefficients[11:19])
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df1 <- tibble(x = x1,
y = sinpi(x1/2),
pred = rcs(x1,10) %*% xgam$coefficients[2:10])
df2 <- tibble(x = x2,
y = cospi(x2/2),
pred = rcs(x2,10) %*% xgam$coefficients[11:19])
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 <- tibble(x = x2,
y = cospi(x2/2),
pred = rcs(x2,10) %*% xgam$coefficients[11:19])
xgam$coefficients |> length()
xgam$coefficients
x1 <- rnorm(1000, 2)
x2 <- rnorm(1000, -4)
y <- 3 + sinpi(x1/2) + cospi(x2/2) + rnorm(1000, sd = 0.5)
df <- tibble(x1, x2, y)
xgam <- gam(y ~ rcs(x1,10) + rcs(x2, 10))
xgam$coefficients
df1 <- tibble(x = x1,
y = sinpi(x1/2),
pred = rcs(x1,10) %*% xgam$coefficients[2:10])
df2 <- tibble(x = x2,
y = cospi(x2/2),
pred = rcs(x2,10) %*% xgam$coefficients[11:19])
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
x1 <- rnorm(1000, 2)
x2 <- rnorm(1000, -4)
y <- sinpi(x1/2) + cospi(x2/2) + rnorm(1000, sd = 0.5)
df <- tibble(x1, x2, y)
xgam <- gam(y ~ rcs(x1,10) + rcs(x2, 10))
xgam$coefficients
df1 <- tibble(x = x1,
y = sinpi(x1/2),
pred = rcs(x1,10) %*% xgam$coefficients[2:10])
df2 <- tibble(x = x2,
y = cospi(x2/2),
pred = rcs(x2,10) %*% xgam$coefficients[11:19])
df1 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
df2 |> ggplot(aes(x, y)) +
geom_point() +
geom_line(aes(x, pred), col = "red")
plot(xgam)
library(brms)
?`brms-package`
?brm
?bernoulli
x <- rnorm(1000)
y_true <- exp(0.75 + 1.3 * x)
y <- rgamma(N, rate = 10 / y_true, shape = 10)
x <- rnorm(1000)
y_true <- exp(0.75 + 1.3 * x)
y <- rgamma(1000, rate = 10 / y_true, shape = 10)
y
glm(y ~ x, family = Gamma())
x <- rnorm(1000)
y_true <- exp(0.75 + 1.3 * x)
y <- rgamma(1000, rate = 10 / y_true, shape = 10)
glm(y ~ x, family = Gamma())
y
glm(y ~ x, family = Gamma())
glm(y ~ x, family = Gamma(link = "log"))
y_true <- 1/(0.75 + 1.3 * x)
y <- rgamma(1000, rate = 10 / y_true, shape = 10)
y_true
x <- rnorm(1000, mean  = 8)
y_true <- 1/(0.75 + 1.3 * x)
y <- rgamma(1000, rate = 10 / y_true, shape = 10)
glm(y ~ x, family = Gamma())
x <- rnorm(1000)
y_true <- exp(0.75 + 1.3 * x)
y <- rgamma(1000, rate = 10 / y_true, shape = 10)
glm(y ~ x, family = Gamma(link = "log"))
x <- rnorm(1000)
y_true <- exp(0.75 + 1.3 * x)
y <- rgamma(1000, rate = 10 / y_true, shape = 10)
glm(y ~ x, family = Gamma(link = "log"))
x <- rnorm(1000)
y_true <- exp(0.75 + 1.3 * x)
y <- rgamma(1000, rate = 10 / y_true, shape = 10)
glm(y ~ x, family = Gamma(link = "log"))
x <- rnorm(1000)
y_true <- exp(0.75 + 1.3 * x)
y <- rgamma(1000, rate = 10 / y_true, shape = 10)
glm(y ~ x, family = Gamma(link = "log"))
x <- rnorm(1000)
y_true <- exp(0.75 + 1.3 * x)
y <- rgamma(1000, rate = 10 / y_true, shape = 10)
brm(y ~ x,
data = tibble(x,y),
family = Gamma(link = "log"))
x <- rnorm(1000)
eta <- exp(2 + 3 * x)
y <- rnbinom(length(eta), mean = , size = theta)
y <- rnbinom(1000, mean = eta, size = 0.5)
?rnbinom
y <- rnbinom(1000, mu = eta, size = 0.5)
y
MASS::glm.nb(y ~ x)
eta <- exp(-0.85 + 1.3 * x)
y <- rnbinom(1000, mu = eta, size = 0.5)
MASS::glm.nb(y ~ x)
MASS::glm.nb(y ~ x) |> coef()
sims <- function(i){
x <- rnorm(1000)
eta <- exp(-0.85 + 1.3 * x)
y <- rnbinom(1000, mu = eta, size = 0.5)
return(MASS::glm.nb(y ~ x) |> coef())
}
?replicate
res <- replicate(10000, sims(1))
res
res <- replicate(10, sims(1))
res |> dim()
res <- replicate(1000, sims(1))
res |> dim()
res
rowMeans(res)
MASS::glm.nb(y ~ x) |> names()
MASS::glm.nb(y ~ x)
MASS::glm.nb(y ~ x) |> summary()
var(y)
sd(y)
?rnbinom
x <- rnorm(1000)
eta <- exp(-0.85 + 1.3 * x)
y <- rpois(1000, lambda = eta)
glm(y ~ x, family = poisson())
x <- rnorm(1000)
eta <- exp(-0.85 + 1.3 * x)
y <- rpois(1000, lambda = eta)
glm(y ~ x, family = poisson())
x <- rnorm(1000)
eta <- exp(-0.85 + 1.3 * x)
y <- rpois(1000, lambda = eta)
glm(y ~ x, family = poisson())
x <- rnorm(1000)
eta <- exp(-0.85 + 1.3 * x)
y <- rpois(1000, lambda = eta)
glm(y ~ x, family = poisson())
x <- rnorm(1000)
eta <- exp(-0.85 + 1.3 * x)
y <- rpois(1000, lambda = eta)
glm(y ~ x, family = poisson())
x <- rnorm(1000)
eta <- exp(-0.85 + 1.3 * x)
y <- rpois(1000, lambda = eta)
glm(y ~ x, family = poisson())
x <- rnorm(1000)
eta <- exp(-0.85 + 1.3 * x)
y <- rpois(1000, lambda = eta)
glm(y ~ x, family = poisson())
x <- rnorm(1000)
eta <- exp(-0.85 + 1.3 * x)
y <- rpois(1000, lambda = eta)
glm(y ~ x, family = poisson())
eta <- boot::inv.logit(-0.85 + 1.3 * x)
y <- rbinom(1000, size = 1, prob = eta)
x <- rnorm(1000)
eta <- boot::inv.logit(-0.85 + 1.3 * x)
y <- rbinom(1000, size = 1, prob = eta)
glm(y ~ x, family = binomial())
x <- rnorm(1000)
eta <- boot::inv.logit(-0.85 + 1.3 * x)
y <- rbinom(1000, size = 1, prob = eta)
glm(y ~ x, family = binomial())
x <- rnorm(1000)
eta <- boot::inv.logit(-0.85 + 1.3 * x)
y <- rbinom(1000, size = 1, prob = eta)
glm(y ~ x, family = binomial())
x <- rnorm(1000)
eta <- boot::inv.logit(-0.85 + 1.3 * x)
y <- rbinom(1000, size = 1, prob = eta)
glm(y ~ x, family = binomial())
x <- rnorm(1000)
eta <- boot::inv.logit(-0.85 + 1.3 * x)
y <- rbinom(1000, size = 1, prob = eta)
glm(y ~ x, family = binomial())
